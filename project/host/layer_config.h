#include "../device/hw_param.cl"

#define NUM_CONFIG_ITEM  25

#ifdef TEST
// Test Layer-1 batch=1
// ResNet Configuration
unsigned layer_config[][NUM_CONFIG_ITEM] = {
							{0,
							224,224,3,7,7,3,64,64,
							0,
							112,112,64,2,3,0,1,
							1,56,56,64,3,2,//maxpool
							0,
							1},//conv-1
							{2,
							56,56,64,3,3,64,64,64,
							7,
							56,56,64,1,1,0,2,
							0,0,0,0,0,0,
							0,
							5},//conv-2
							{2,
							56,56,64,3,3,64,64,64,
							6,
							56,56,64,1,1,0,2,
							0,0,0,0,0,0,
							0,
							5},//conv-3
							{2,
							56,56,64,3,3,64,64,64,
							6,
							56,56,64,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-4
							{2,
							56,56,64,3,3,64,64,64,
							6,
							56,56,64,1,1,0,0,
							2,28,28,64,2,2, //stride pool, only work for the fixpoint output
							0,
							5},//conv-5
							{2,
							56,56,64,3,3,64,128,128,
							6,
							28,28,128,2,1,0,0,
							0,0,0,0,0,0,
							0,
							0},//conv-6
							{0,
							28,28,64,1,1,64,128,128,
							1,
							28,28,128,1,0,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-7 followed by conv-5
							{2,
							28,28,128,3,3,128,128,128,
							6,
							28,28,128,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-8
							{2,
							28,28,128,3,3,128,128,128,
							6,
							28,28,128,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-9	
							{2,
							28,28,128,3,3,128,128,128,
							6,
							28,28,128,1,1,0,0,
							2,14,14,128,2,2, //stride pool, only work for the fixpoint output
							0,
							5},//conv-10
							{2,
							28,28,128,3,3,128,256,256,
							6,
							14,14,256,2,1,0,0,
							0,0,0,0,0,0,
							0,
							1},//conv-11
							{0,
							14,14,128,1,1,128,256,256,
							0,
							14,14,256,1,0,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-12 followed by conv-10
							{2,
							14,14,256,3,3,256,256,256,
							6,
							14,14,256,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-13
							{2,
							14,14,256,3,3,256,256,256,
							6,
							14,14,256,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-14
							{2,
							14,14,256,3,3,256,256,256,
							6,
							14,14,256,1,1,0,0,
							2,7,7,256,2,2, //stride pool, only work for the fixpoint output
							0,
							5},//conv-15
							{2,
							14,14,256,3,3,256,512,512,
							6,
							7,7,512,2,1,0,0,
							0,0,0,0,0,0,
							0,
							0},//conv-16
							{0,
							7,7,256,1,1,256,512,512,
							1,
							7,7,512,1,0,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-17 followed by conv-15
							{2,
							7,7,512,3,3,512,512,512,
							6,
							7,7,512,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-18
							{2,
							7,7,512,3,3,512,512,512,
							6,
							7,7,512,1,1,0,0,
							0,0,0,0,0,0,
							0,
							5},//conv-19
							{2,
							7,7,512,3,3,512,512,512,
							6,
							7,7,512,1,1,0,0,
							3,1,1,512,7,0, //avg pool
							0,
							5},//conv-20
							{1,
							1,1,512,1,1,512,1024,1024,
							0,
							1,1,1024,1,0,0,0,
							0,0,0,0,0,0,
							0,
							3,
							}//fc-21
							
							};
char precision_config[][3] ={
	// frac_w(sw), frac_din, frac_dout
							{ 8, 5,	4},// Layer-1
							{12, 0, 6},// Layer-2
							{12, 0, 5},// Layer-3
							{12, 0, 5},// Layer-4
							{12, 0, 5},// Layer-5
							{13, 0, 5},// Layer-6
							{ 7, 6, 5},// Layer-7
							{13, 0, 5},// layer-8
							{12, 0, 5},// layer-9
							{12, 0, 5},// layer-10
							{13, 0, 5},// layer-11
							{ 7, 6, 5},// layer-12
							{13, 0, 5},// layer-13
							{12, 0, 4},// layer-14
							{13, 0, 4},// layer-15
							{14, 0, 5},// layer-16
							{ 8, 6, 5},// layer-17
							{13, 6, 4},// layer-18
							{13, 6, 4},// layer-19
							{13, 6, 5},// layer-20
							{ 1, 7,-1},// layer-21
							};

char addition_precision_config[][4]={
	// bn_dout,elt_din1_fl,elt_din2_fl,elt_dout_fl,
							{0, 0, 0, 0},//	layer-1
							{0, 6, 6, 6},// layer-2
							{0, 6, 5, 5},// layer-3
							{0, 6, 5, 5},// layer-4
							{0, 6, 5, 5},// layer-5
							{0, 0, 0, 0},//	layer-6
							{0, 5, 5, 5},//	layer-7
							{0, 6, 5, 5},// layer-8
							{0, 6, 5, 5},// layer-9
							{0, 6, 5, 5},// layer-10
							{0, 0, 0, 0},//	layer-11
							{0, 5, 5, 5},//	layer-12
							{0, 6, 5, 5},// layer-13
							{0, 6, 6, 4},// layer-14
							{0, 6, 4, 4},// layer-15
							{0, 0, 0, 0},//	layer-16
							{0, 5, 5, 5},//	layer-17
							{0, 6, 4, 4},//	layer-18
							{0, 6, 4, 4},//	layer-19
							{0, 6, 5, 5},//	layer-20
							{0, 0, 0, 0} // layer-21
};

//which conv layer follow eltwise layer
char eltwise_config[][5]={
	           // eltwise_on,in_1, 2,out, act_ctrl
							{0, 0, 0, 0, 0},// layer-1
							{1, 4, 5, 0, 1},// layer-2
							{1, 0, 5, 1, 1},// layer-3
							{1, 1, 5, 0, 1},// layer-4
							{1, 0, 5, 1, 1},// layer-5
							{0, 0, 0, 0, 0},// layer-6
							{1, 0, 5, 1, 1},// layer-7
							{1, 1, 5, 0, 1},// layer-8
							{1, 0, 5, 1, 1},// layer-9
							{1, 1, 5, 0, 1},// layer-10
							{0, 0, 0, 0, 0},// layer-11
							{1, 1, 5, 0, 1},// layer-12
							{1, 0, 5, 1, 1},// layer-13
							{1, 1, 5, 0, 1},// layer-14
							{1, 0, 5, 1, 1},// layer-15
							{0, 0, 0, 0, 0},// layer-16
							{1, 0, 5, 1, 1},// layer-17
							{1, 1, 5, 0, 1},// layer-18
							{1, 0, 5, 1, 1},// layer-19
							{1, 1, 5, 0, 1},// layer-20
							{0, 0, 0, 0, 0},// layer-21
};
// Scale hard tanh       1,    2,    3,    4,    5,  [7],    8,    9,   10, [12],   13,   14,   15,   17,   18,   19,   20
char ACT_ALPHA[]   = {  96,   93,   71,   71,   72,  108,   70,  115,  116,  123,   65,  118,  116,   65,   67,  111,  113};
char ACT_ALPHA_FL[]= {   6,    6,    6,    6,    6,    6,    6,    7,    7,    6,    6,    7,    7,    5,    6,    7,    7};
char ACT_BETA[]    = {  -8,   15,    5,    6,   12,    7,    3,    6,    9,   12,    6,    0,    9,  -12,    3,   -6,  -55}; //beta and the input share the same fl
char ACT_OUT_FL[]  = {   6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    6,    7};
short ACT_N_THRE[] = {-128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -256};
short ACT_P_THRE[] = { 128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  128,  254};
//Input
unsigned input_config[4] = {224, 224, 3, 1};

//Output
// unsigned output_config[3]= {112, 112,  64}; //Layer-1
// unsigned output_config[3] = { 56,  56,  64}; // Layer-1
// unsigned output_config[3] = { 28,  28, 128}; // Layer 6,7,8,9
// unsigned output_config[3] = { 14,  14, 256}; // Layer 12
// unsigned output_config[3] = { 7,  7, 512}; // Layer 16,17,18,19,20
// unsigned output_config[3] = { 1,  1, 512};//layer20 avgpool
unsigned output_config[3] = { 1,  1, 1024};//layer20 avgpool
#endif
